

# 04_Annotate mRNA
# 04_1 index reference annotations:
# 04_2 map to transcriptome:

# 04_2 map to genome:
from Melina:
module add UHTS/Aligner/bowtie/1.2.0
bowtie -p 4 RNA_index SRR1944912.fastq --un SRR1944912_no_RNA.fastq 2> my_errors.txt


# 02_2_Quality control of cleaned sequences:  ------------------------------------
#SBATCH --cpus-per-task=2                                                       # allocate computational resources for the task
#SBATCH --mem-per-cpu=1000M
# in RNAseq:
for i in $(ls -d 01_Data/03_bowtie_out/*.fq);
do ./00_Software/FastQC/fastqc --outdir=./02_IntermOutput/02_cleanQC/ $i;          # do FastQC analysis for each file & save to output-directory
done


# 3) download reference genome and transcriptome annotations:
# 3_1) for reference transcriptome, go to:
http://www.ensembl.org/biomart/martview/4e9648722de7cb0da23cf319e08eb5e6?VIRTUALSCHEMANAME=default&ATTRIBUTES=scerevisiae_gene_ensembl.default.sequences.ensembl_gene_id|scerevisiae_gene_ensembl.default.sequences.ensembl_transcript_id|scerevisiae_gene_ensembl.default.sequences.coding|scerevisiae_gene_ensembl.default.sequences.external_gene_name|scerevisiae_gene_ensembl.default.sequences.upstream_flank."18"|scerevisiae_gene_ensembl.default.sequences.downstream_flank."18"&FILTERS=scerevisiae_gene_ensembl.default.filters.transcript_biotype."protein_coding"&VISIBLEPANEL=resultspanel
# copy to 001_Data/03_RefAnnot on Ubuntu or cluster as above
# 3_2) for reference genome:
cd /001_Data/03_RefAnnot
wget --output-document yeastGenome_ref.fa.gz ftp://ftp.ensembl.org/pub/release-101/fasta/saccharomyces_cerevisiae/dna/Saccharomyces_cerevisiae.R64-1-1.dna.toplevel.fa.gz
# for gtf of genome, type:
wget --output-document yeastGenome_refGTF.gtf.gz ftp://ftp.ensembl.org/pub/release-101/gtf/saccharomyces_cerevisiae/Saccharomyces_cerevisiae.R64-1-1.101.gtf.gz



# 5) prepare indeces for bowtie-mapping:                                        # bowtie-build depends on python3, which cannot be installed on our server. Hence, the indeces must be built on your local machine, and then uploaded to the server for mapping

# 5_2) transcriptome Annotations indexing:
bowtie-build mart_exportTranscriptome.txt transcriptome
scp ./transcriptome* trey@binfservms01.unibe.ch:/data/users/trey/RNAseq/01_Data/03_Transcrpt_refAnnot/

# 5_3) genome Annotations indexing:
bowtie-build Saccharomyces_cerevisiae.R64-1-1.dna.toplevel.fa R64_genome
scp ./R64_genome* $USER@binfservms01.unibe.ch:/data/users/$USER/RNAseq/01_Data/04_Genome_refAnnot/





# ------------------------------------------------------------------------------
